#!/usr/bin/env python

from licenses.db import db
import json
import sys
import os

def get_things(folder):
    for f in os.listdir(folder):
        yield json.load(open("%s/%s" % (folder, f), 'r'))

for guy in get_things(sys.argv[1]):
    guy['_id'] = guy['slug']
    db.licenses.update({"_id": guy['slug']},
                       guy,
                       True,  # upsert
                       safe=True)
    print "Imported %s" % (guy['slug'])
